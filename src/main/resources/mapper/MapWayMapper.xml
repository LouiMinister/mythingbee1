<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.antybeety.map.way.mybatis.MapWayMapper">

    <resultMap id="node_info" type="com.antybeety.map.way.model.vo.NodeVO">
        <id property="nodeId" column="node_id" jdbcType="INTEGER"/>
        <id property="lat" column="lat" jdbcType="DOUBLE"/>
        <id property="lng" column="lon" jdbcType="DOUBLE"/>
    </resultMap>

    <resultMap id="edge_info" type="com.antybeety.map.way.model.vo.EdgeVO">
        <id property="edgeId" column="edge_id" jdbcType="INTEGER"/>
        <id property="nodeStart" column="node_s" jdbcType="INTEGER"/>
        <id property="nodeEnd" column="node_e" jdbcType="INTEGER"/>
    </resultMap>

<!--    모든 노드(교차로 + 속도 변화 구간) 정보 가져오기 -->
    <select id="getAllNode" parameterType="hashmap" resultMap="node_info">
        SELECT node_id, lat, lon FROM node_tb
    </select>

<!--    노드 데이터 갖고오기 구현 미완 -->
    <select id="getAllNodeData" parameterType="hashmap" resultMap="node_info">
        SELECT node_id, lat, lon FROM node_tb
    </select>

<!--    간선 정보 가져오기 -->
    <select id="getAllEdge" parameterType="hashmap" resultMap="edge_info">
        SELECT edge_id, node_s, node_e FROM edge_tb
    </select>

<!--    노드 추가-->
    <insert id="addNode" parameterType="hashmap" statementType="PREPARED">
        insert into node_tb (node_id, lat, lon) values(${index}, ${lat}, ${lon})
    </insert>

<!--    간선 추가-->
    <insert id="addEdge"  parameterType="hashmap">
        insert into edge_tb (edge_id, node_s, node_e, dist_value) values(${index}, ${startNode}, ${endNode}, #{distance})
    </insert>

<!--    노드 삭제-->
    <delete id="deleteNode" parameterType="java.lang.Long">
        delete from node_tb where node_id = #{nodeId} ;
    </delete>

<!--    간선 삭제-->
    <delete id="deleteEdge">
        delete from edge_tb where edge_id = #{edgeId} ;
    </delete>

<!--    간선에 위도 경도 주소 세팅 -->
    <update id="setLocation" parameterType="hashmap">
        update edge_tb set lat = ${lat}, lon =${lon} where edge_id = ${id} ;
    </update>
</mapper>